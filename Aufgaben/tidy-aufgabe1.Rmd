---
title: "Aufgaben"
output: html_document
---

# Tidy data

Wir generieren eine Datensatz mit Messwiederholung. Gemessen wurde die Zeit (in Minuten), welche 6 Personen an ihrem Handy verbringen, an zwei Orten (Zuhause und bei der Arbeit), zu zwei Messzeitpunkten.

Jede Person wird zufällig einer Gruppe ('treatment' oder 'control') zugewiesen.

```{r}
library(tidyr)
library(dplyr)
```

```{r}
set.seed(1234)
n_subj <- 6

messy <- data_frame(id = 1:n_subj,
                    group = sample(rep(c('control', 'treatment'),
                                     each = 3)),
                    work_T1 = floor(rnorm(n_subj, 20, 2)),
                    home_T1 = floor(rnorm(n_subj, 60, 2)),
                    work_T2 = floor(rnorm(n_subj, 30, 2)),
                    home_T2 = floor(rnorm(n_subj, 50, 2)))
```


Der Datensatz sieht so aus:
```{r}
messy
```




Natürlich ist dieser Datensatz im 'wide' Format.


## Aufgabe 1
Konvertieren Sie den Datensatz ins 'long' Format. Achtung: Wir haben 2 Faktoren, `Ort` und `Zeit`. Wir können zuerst die Funktion `gather()` verwenden, und dabei die beiden als einen Faktor behandeln. Anschliessend benutzen wir eine neue Funktion im `tidyr` package, `separate()`, um die `key` Variable zu trennen. 

Schauen Sie die Funktion `separate()` im Help Viewer nach.



## Aufgabe 2
- Wählen Sie die Daten der Person 2 aus.

- Wählen Sie die Daten der Treatment-Gruppe aus.


## Aufgabe 3
Fügen Sie dem Datensatz als neue Variable die Zeit in Stunden hinzu.



## Aufgabe 4
Berechnen Sie die mittlere am Handy verbrachten Zeit

- für jede Person
- für jeden Ort
- für jeden Messzeitpunkt

```{r}
data<-gather(messy, key = factor, value = time, -id,-group, factor_key = T) %>% 
  separate(factor,c("Place","Time"))


data[data$id==2,]
data[data$group=="treatment",]
data[data$id<4 &data$id>2,]
data %>% filter(id==2)
data %>% filter(group=="treatment")
data$hours<-data$time/60
data<-mutate(data,HOURS<-time/60)


group_by(data,id)
aggregate(data, list(data$id), FUN = mean)
aggregate(data,list(data$Place), FUN = mean)
aggregate(data,list(data$Time), FUN =mean)

```

